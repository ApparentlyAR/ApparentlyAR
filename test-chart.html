<!DOCTYPE html>
<html>
<head>
    <title>Chart Test</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.js"></script>
</head>
<body>
    <h1>Chart Generation Test</h1>
    <div style="width: 600px; margin: 20px;">
        <canvas id="testChart"></canvas>
    </div>
    
    <script>
        async function testChartGeneration() {
            try {
                // Test data fetch
                const dataResponse = await fetch('http://localhost:3000/api/test-data/students');
                const dataResult = await dataResponse.json();
                console.log('Data fetch result:', dataResult);
                
                // Test chart generation
                const chartResponse = await fetch('http://localhost:3000/api/generate-chart', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        data: dataResult.data,
                        chartType: 'bar',
                        options: { xColumn: 'name', yColumn: 'score', title: 'Student Scores Test' }
                    })
                });
                
                const chartResult = await chartResponse.json();
                console.log('Chart generation result:', chartResult);
                
                // Render chart
                const ctx = document.getElementById('testChart').getContext('2d');
                new Chart(ctx, {
                    type: chartResult.chartType,
                    data: chartResult.config.data,
                    options: chartResult.config.options
                });
                
                console.log('Chart rendered successfully!');
            } catch (error) {
                console.error('Error:', error);
            }
        }
        
        // Run test when page loads
        document.addEventListener('DOMContentLoaded', testChartGeneration);
    </script>
</body>
</html>